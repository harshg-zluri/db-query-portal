{
    "info": {
        "_postman_id": "db-query-portal-collection",
        "name": "DB Query Portal API",
        "description": "Complete API collection for the Database Query Execution Portal.\n\n**Quick Start:**\n1. Run 'Login' request first to auto-populate tokens\n2. All other requests will use the saved access token automatically\n\n**Test Users:**\n- Admin: admin@zluri.com / Admin@123\n- Manager: manager@zluri.com / Manager@123\n- Developer: dev@zluri.com / Dev@123\n\n**Features:**\n- Authentication (Login, Logout, Refresh, OAuth)\n- Database Discovery\n- POD Management\n- Request Submission (Query & Script)\n- Approval Workflows\n- Admin Management\n\nFor detailed documentation, see FEATURE_DOCUMENTATION.md",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:3000/api",
            "type": "string"
        },
        {
            "key": "accessToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "refreshToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "requestId",
            "value": "",
            "type": "string",
            "description": "Stores the last created request ID"
        },
        {
            "key": "userId",
            "value": "",
            "type": "string",
            "description": "Stores the last created user ID"
        }
    ],
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{accessToken}}",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "ðŸ” Authentication",
            "description": "Authentication endpoints for login, logout, token refresh, OAuth, and profile management",
            "item": [
                {
                    "name": "Login (Developer)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.data && jsonData.data.accessToken) {",
                                    "        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                    "        pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                    "        console.log('âœ… Tokens saved to collection variables');",
                                    "    }",
                                    "}",
                                    "",
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Response has accessToken', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.have.property('accessToken');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"dev@zluri.com\",\n    \"password\": \"Dev@123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Authenticate as a Developer user.\n\n**Permissions:** Can submit queries/scripts, view own submissions."
                    },
                    "response": []
                },
                {
                    "name": "Login (Manager)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.data && jsonData.data.accessToken) {",
                                    "        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                    "        pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                    "        console.log('âœ… Tokens saved to collection variables');",
                                    "    }",
                                    "}",
                                    "",
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('User role is manager', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data.user.role).to.equal('manager');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"manager@zluri.com\",\n    \"password\": \"Manager@123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Authenticate as a Manager user.\n\n**Permissions:** Can approve/reject requests for managed PODs."
                    },
                    "response": []
                },
                {
                    "name": "Login (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.data && jsonData.data.accessToken) {",
                                    "        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                    "        pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                    "        console.log('âœ… Tokens saved to collection variables');",
                                    "    }",
                                    "}",
                                    "",
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('User role is admin', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data.user.role).to.equal('admin');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"admin@zluri.com\",\n    \"password\": \"Admin@123\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Authenticate as an Admin user.\n\n**Permissions:** Full access including user/POD management."
                    },
                    "response": []
                },
                {
                    "name": "Logout",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    pm.collectionVariables.set('accessToken', '');",
                                    "    pm.collectionVariables.set('refreshToken', '');",
                                    "    console.log('âœ… Tokens cleared from collection variables');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/logout",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "logout"
                            ]
                        },
                        "description": "Logout the current user. Clears saved tokens."
                    },
                    "response": []
                },
                {
                    "name": "Refresh Token",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    if (jsonData.data && jsonData.data.accessToken) {",
                                    "        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                    "        pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                    "        console.log('âœ… Tokens refreshed and saved');",
                                    "    }",
                                    "}",
                                    "",
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"refreshToken\": \"{{refreshToken}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/refresh",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "refresh"
                            ]
                        },
                        "description": "Refresh access token using a valid refresh token.\n\n**Note:** Uses the saved refreshToken variable."
                    },
                    "response": []
                },
                {
                    "name": "Get Profile",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Response has user data', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.have.property('email');",
                                    "    pm.expect(data).to.have.property('role');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/me",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "me"
                            ]
                        },
                        "description": "Get current user's profile information."
                    },
                    "response": []
                },
                {
                    "name": "Google OAuth - Initiate",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/google",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "google"
                            ]
                        },
                        "description": "Initiate Google OAuth flow.\n\n**Note:** This will redirect to Google's OAuth consent screen. Use in browser, not Postman."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "ðŸ—„ï¸ Databases",
            "description": "Database discovery and instance management endpoints",
            "item": [
                {
                    "name": "Get Database Types",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Returns array of types', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.be.an('array');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/types",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                "types"
                            ]
                        },
                        "description": "Get list of available database types.\n\n**Returns:** `['postgresql', 'mongodb']`"
                    },
                    "response": []
                },
                {
                    "name": "Get All Database Instances",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Returns array of instances', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.be.an('array');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/instances",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                "instances"
                            ]
                        },
                        "description": "Get list of all database instances."
                    },
                    "response": []
                },
                {
                    "name": "Get PostgreSQL Instances",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/instances?type=postgresql",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                "instances"
                            ],
                            "query": [
                                {
                                    "key": "type",
                                    "value": "postgresql"
                                }
                            ]
                        },
                        "description": "Get database instances filtered by PostgreSQL type."
                    },
                    "response": []
                },
                {
                    "name": "Get MongoDB Instances",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/instances?type=mongodb",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                "instances"
                            ],
                            "query": [
                                {
                                    "key": "type",
                                    "value": "mongodb"
                                }
                            ]
                        },
                        "description": "Get database instances filtered by MongoDB type."
                    },
                    "response": []
                },
                {
                    "name": "Get Databases for Instance",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/:instanceId/databases",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                ":instanceId",
                                "databases"
                            ],
                            "variable": [
                                {
                                    "key": "instanceId",
                                    "value": "prod-postgres-main",
                                    "description": "Database instance ID"
                                }
                            ]
                        },
                        "description": "Get list of databases available on a specific instance."
                    },
                    "response": []
                },
                {
                    "name": "Get Instance Details",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/databases/:instanceId",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "databases",
                                ":instanceId"
                            ],
                            "variable": [
                                {
                                    "key": "instanceId",
                                    "value": "prod-postgres-main",
                                    "description": "Database instance ID"
                                }
                            ]
                        },
                        "description": "Get detailed information about a specific database instance."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "ðŸ‘¥ PODs",
            "description": "POD (team) management endpoints",
            "item": [
                {
                    "name": "Get All PODs",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Returns array of PODs', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.be.an('array');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/pods",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "pods"
                            ]
                        },
                        "description": "Get list of all PODs (teams)."
                    },
                    "response": []
                },
                {
                    "name": "Get POD by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/pods/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "pods",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "pod-backend",
                                    "description": "POD ID"
                                }
                            ]
                        },
                        "description": "Get details of a specific POD."
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "ðŸ“ Requests - Submit",
            "description": "Submit new query and script requests",
            "item": [
                {
                    "name": "Submit PostgreSQL Query",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 201', () => pm.response.to.have.status(201));",
                                    "",
                                    "if (pm.response.code === 201) {",
                                    "    const data = pm.response.json().data;",
                                    "    if (data && data.id) {",
                                    "        pm.collectionVariables.set('requestId', data.id);",
                                    "        console.log('âœ… Request ID saved:', data.id);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"databaseType\": \"postgresql\",\n    \"instanceId\": \"prod-postgres-main\",\n    \"databaseName\": \"zluri_prod\",\n    \"submissionType\": \"query\",\n    \"query\": \"SELECT id, email, created_at FROM users LIMIT 10;\",\n    \"podId\": \"pod-backend\",\n    \"comments\": \"Fetching sample user data for analysis\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/requests",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests"
                            ]
                        },
                        "description": "Submit a new PostgreSQL query for approval.\n\n**Required Fields:**\n- databaseType: 'postgresql'\n- instanceId: Target instance ID\n- databaseName: Target database\n- submissionType: 'query'\n- query: SQL query\n- podId: Your team's POD ID\n- comments: Reason for request"
                    },
                    "response": []
                },
                {
                    "name": "Submit MongoDB Query",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 201', () => pm.response.to.have.status(201));",
                                    "",
                                    "if (pm.response.code === 201) {",
                                    "    const data = pm.response.json().data;",
                                    "    if (data && data.id) {",
                                    "        pm.collectionVariables.set('requestId', data.id);",
                                    "        console.log('âœ… Request ID saved:', data.id);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"databaseType\": \"mongodb\",\n    \"instanceId\": \"prod-mongodb-cache\",\n    \"databaseName\": \"zluri_sessions\",\n    \"submissionType\": \"query\",\n    \"query\": \"db.sessions.find({}).limit(10)\",\n    \"podId\": \"pod-backend\",\n    \"comments\": \"Checking session data for debugging\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/requests",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests"
                            ]
                        },
                        "description": "Submit a new MongoDB query for approval.\n\n**Supported MongoDB Methods:**\n- find, findOne, aggregate\n- insertOne, insertMany\n- updateOne, updateMany\n- deleteOne, deleteMany\n- countDocuments"
                    },
                    "response": []
                },
                {
                    "name": "Submit Script (File Upload)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 201', () => pm.response.to.have.status(201));",
                                    "",
                                    "if (pm.response.code === 201) {",
                                    "    const data = pm.response.json().data;",
                                    "    if (data && data.id) {",
                                    "        pm.collectionVariables.set('requestId', data.id);",
                                    "        console.log('âœ… Request ID saved:', data.id);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [],
                        "body": {
                            "mode": "formdata",
                            "formdata": [
                                {
                                    "key": "databaseType",
                                    "value": "postgresql",
                                    "type": "text"
                                },
                                {
                                    "key": "instanceId",
                                    "value": "prod-postgres-main",
                                    "type": "text"
                                },
                                {
                                    "key": "databaseName",
                                    "value": "zluri_prod",
                                    "type": "text"
                                },
                                {
                                    "key": "submissionType",
                                    "value": "script",
                                    "type": "text"
                                },
                                {
                                    "key": "podId",
                                    "value": "pod-backend",
                                    "type": "text"
                                },
                                {
                                    "key": "comments",
                                    "value": "Data migration script for user cleanup",
                                    "type": "text"
                                },
                                {
                                    "key": "script",
                                    "type": "file",
                                    "src": "",
                                    "description": "Select a .js script file"
                                }
                            ]
                        },
                        "url": {
                            "raw": "{{baseUrl}}/requests",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests"
                            ]
                        },
                        "description": "Submit a JavaScript script for approval.\n\n**Script Environment:**\n- Access to `POSTGRES_URL` or `MONGODB_URL` env vars\n- `DB_NAME` and `DB_TYPE` also available\n- 30s timeout, 128MB memory limit\n\n**Blocked APIs:**\n- child_process, eval, Function constructor\n- process.exit, direct fs module access"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "ðŸ“‹ Requests - View",
            "description": "View and manage submitted requests",
            "item": [
                {
                    "name": "Get My Requests",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Returns paginated data', () => {",
                                    "    const json = pm.response.json();",
                                    "    pm.expect(json).to.have.property('data');",
                                    "    pm.expect(json).to.have.property('pagination');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/my?page=1&limit=20",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "my"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "20"
                                },
                                {
                                    "key": "status",
                                    "value": "pending",
                                    "description": "Filter: pending, approved, executed, failed, rejected, withdrawn",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Get current user's submitted requests with pagination.\n\n**Query Params:**\n- page: Page number (default 1)\n- limit: Items per page (default 20)\n- status: Filter by status"
                    },
                    "response": []
                },
                {
                    "name": "Get My Pending Requests",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/my?status=pending",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "my"
                            ],
                            "query": [
                                {
                                    "key": "status",
                                    "value": "pending"
                                }
                            ]
                        },
                        "description": "Get only pending requests for the current user."
                    },
                    "response": []
                },
                {
                    "name": "Get Request by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/{{requestId}}",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "{{requestId}}"
                            ]
                        },
                        "description": "Get details of a specific request.\n\n**Note:** Uses saved requestId variable."
                    },
                    "response": []
                },
                {
                    "name": "Withdraw Request",
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/{{requestId}}/withdraw",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "{{requestId}}",
                                "withdraw"
                            ]
                        },
                        "description": "Withdraw a pending request.\n\n**Requirements:**\n- Must be the request owner\n- Request must be in 'pending' status"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "âœ… Approvals (Manager+)",
            "description": "Approval workflow endpoints - requires Manager or Admin role",
            "item": [
                {
                    "name": "Get Pending Requests",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/pending?page=1&limit=20",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "pending"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "20"
                                }
                            ]
                        },
                        "description": "Get all pending requests awaiting approval.\n\n**Role Required:** Manager or Admin\n\n**Managers:** See only requests for their managed PODs\n**Admins:** See all pending requests"
                    },
                    "response": []
                },
                {
                    "name": "Get All Requests",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests?page=1&limit=20",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "20"
                                },
                                {
                                    "key": "status",
                                    "value": "approved",
                                    "disabled": true
                                },
                                {
                                    "key": "podId",
                                    "value": "pod-backend",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Get all requests with optional filters.\n\n**Role Required:** Manager or Admin"
                    },
                    "response": []
                },
                {
                    "name": "Approve Request",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/requests/{{requestId}}/approve",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "{{requestId}}",
                                "approve"
                            ]
                        },
                        "description": "Approve a pending request and trigger execution.\n\n**Role Required:** Manager (for own PODs) or Admin\n\n**Post-Approval:**\n- Job is enqueued for execution\n- Slack notification sent\n- Status updates to 'executed' or 'failed'"
                    },
                    "response": []
                },
                {
                    "name": "Reject Request",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"reason\": \"Query is too broad. Please add more specific filters to limit the result set.\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/requests/{{requestId}}/reject",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "requests",
                                "{{requestId}}",
                                "reject"
                            ]
                        },
                        "description": "Reject a pending request with a reason.\n\n**Role Required:** Manager (for own PODs) or Admin\n\n**Body:**\n- reason: Explanation for rejection (optional but recommended)"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "âš™ï¸ Admin (Admin Only)",
            "description": "Administrative endpoints - requires Admin role",
            "item": [
                {
                    "name": "Get All Users",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', () => pm.response.to.have.status(200));",
                                    "pm.test('Returns array of users', () => {",
                                    "    const data = pm.response.json().data;",
                                    "    pm.expect(data).to.be.an('array');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/admin/users",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "users"
                            ]
                        },
                        "description": "Get list of all users.\n\n**Role Required:** Admin"
                    },
                    "response": []
                },
                {
                    "name": "Get User by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/admin/users/:id",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "users",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{userId}}",
                                    "description": "User ID"
                                }
                            ]
                        },
                        "description": "Get details of a specific user.\n\n**Role Required:** Admin"
                    },
                    "response": []
                },
                {
                    "name": "Create User",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    const data = pm.response.json().data;",
                                    "    if (data && data.id) {",
                                    "        pm.collectionVariables.set('userId', data.id);",
                                    "        console.log('âœ… User ID saved:', data.id);",
                                    "    }",
                                    "}",
                                    "",
                                    "pm.test('Status code is 201', () => pm.response.to.have.status(201));"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"newuser@zluri.com\",\n    \"password\": \"SecurePass@123\",\n    \"name\": \"New User\",\n    \"role\": \"developer\",\n    \"managedPodIds\": []\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/admin/users",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "users"
                            ]
                        },
                        "description": "Create a new user.\n\n**Role Required:** Admin\n\n**Body:**\n- email: User email (unique)\n- password: Strong password\n- name: Display name\n- role: 'developer', 'manager', or 'admin'\n- managedPodIds: Array of POD IDs (for managers)"
                    },
                    "response": []
                },
                {
                    "name": "Update User",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Updated Name\",\n    \"role\": \"manager\",\n    \"managedPodIds\": [\"pod-backend\"]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/admin/users/{{userId}}",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "users",
                                "{{userId}}"
                            ]
                        },
                        "description": "Update an existing user.\n\n**Role Required:** Admin\n\n**Updatable Fields:**\n- name, role, managedPodIds, password"
                    },
                    "response": []
                },
                {
                    "name": "Delete User",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/admin/users/{{userId}}",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "users",
                                "{{userId}}"
                            ]
                        },
                        "description": "Delete a user.\n\n**Role Required:** Admin\n\n**Warning:** This action is irreversible."
                    },
                    "response": []
                },
                {
                    "name": "Get PODs (Admin)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/admin/pods",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "admin",
                                "pods"
                            ]
                        },
                        "description": "Get all PODs for user assignment.\n\n**Role Required:** Admin"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "ðŸ§ª Testing Scenarios",
            "description": "Pre-configured test scenarios for common workflows",
            "item": [
                {
                    "name": "Full Flow - Submit and Approve",
                    "item": [
                        {
                            "name": "1. Login as Developer",
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "exec": [
                                            "if (pm.response.code === 200) {",
                                            "    const jsonData = pm.response.json();",
                                            "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                            "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                            "}"
                                        ],
                                        "type": "text/javascript"
                                    }
                                }
                            ],
                            "request": {
                                "auth": {
                                    "type": "noauth"
                                },
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n    \"email\": \"dev@zluri.com\",\n    \"password\": \"Dev@123\"\n}"
                                },
                                "url": {
                                    "raw": "{{baseUrl}}/auth/login",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "auth",
                                        "login"
                                    ]
                                }
                            },
                            "response": []
                        },
                        {
                            "name": "2. Submit Query Request",
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "exec": [
                                            "if (pm.response.code === 201) {",
                                            "    const data = pm.response.json().data;",
                                            "    pm.collectionVariables.set('requestId', data.id);",
                                            "}"
                                        ],
                                        "type": "text/javascript"
                                    }
                                }
                            ],
                            "request": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n    \"databaseType\": \"postgresql\",\n    \"instanceId\": \"prod-postgres-main\",\n    \"databaseName\": \"zluri_prod\",\n    \"submissionType\": \"query\",\n    \"query\": \"SELECT COUNT(*) FROM users;\",\n    \"podId\": \"pod-backend\",\n    \"comments\": \"Test query for approval flow\"\n}"
                                },
                                "url": {
                                    "raw": "{{baseUrl}}/requests",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "requests"
                                    ]
                                }
                            },
                            "response": []
                        },
                        {
                            "name": "3. Login as Manager",
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "exec": [
                                            "if (pm.response.code === 200) {",
                                            "    const jsonData = pm.response.json();",
                                            "    pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
                                            "    pm.collectionVariables.set('refreshToken', jsonData.data.refreshToken);",
                                            "}"
                                        ],
                                        "type": "text/javascript"
                                    }
                                }
                            ],
                            "request": {
                                "auth": {
                                    "type": "noauth"
                                },
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n    \"email\": \"manager@zluri.com\",\n    \"password\": \"Manager@123\"\n}"
                                },
                                "url": {
                                    "raw": "{{baseUrl}}/auth/login",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "auth",
                                        "login"
                                    ]
                                }
                            },
                            "response": []
                        },
                        {
                            "name": "4. View Pending Requests",
                            "request": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{baseUrl}}/requests/pending",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "requests",
                                        "pending"
                                    ]
                                }
                            },
                            "response": []
                        },
                        {
                            "name": "5. Approve Request",
                            "request": {
                                "method": "POST",
                                "header": [],
                                "url": {
                                    "raw": "{{baseUrl}}/requests/{{requestId}}/approve",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "requests",
                                        "{{requestId}}",
                                        "approve"
                                    ]
                                }
                            },
                            "response": []
                        },
                        {
                            "name": "6. Check Execution Result",
                            "request": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{baseUrl}}/requests/{{requestId}}",
                                    "host": [
                                        "{{baseUrl}}"
                                    ],
                                    "path": [
                                        "requests",
                                        "{{requestId}}"
                                    ]
                                }
                            },
                            "response": []
                        }
                    ]
                }
            ]
        }
    ]
}